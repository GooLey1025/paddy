2025-05-20 16:43:55.804892: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-20 16:43:55.823855: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-05-20 16:43:55.823887: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-05-20 16:43:55.824407: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-20 16:43:55.827321: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-20 16:43:56.121691: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-05-20 16:43:56.538153: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:43:56.569432: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:43:56.570803: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:43:56.627227: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:43:56.628597: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:43:56.630045: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:43:56.701145: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:43:56.702125: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:43:56.703011: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:43:56.703890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1929] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9785 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070, pci bus id: 0000:01:00.0, compute capability: 8.9
Model: "model_1"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 tracks (InputLayer)         [(None, 106, 1024)]          0         []                            
                                                                                                  
 layer_normalization (Layer  (None, 106, 1024)            2048      ['tracks[0][0]']              
 Normalization)                                                                                   
                                                                                                  
 multihead_attention (Multi  (None, 106, 1024)            3278848   ['layer_normalization[0][0]'] 
 headAttention)                                                                                   
                                                                                                  
 dropout (Dropout)           (None, 106, 1024)            0         ['multihead_attention[0][0]'] 
                                                                                                  
 add (Add)                   (None, 106, 1024)            0         ['tracks[0][0]',              
                                                                     'dropout[0][0]']             
                                                                                                  
 layer_normalization_1 (Lay  (None, 106, 1024)            2048      ['add[0][0]']                 
 erNormalization)                                                                                 
                                                                                                  
 dense (Dense)               (None, 106, 2048)            2099200   ['layer_normalization_1[0][0]'
                                                                    ]                             
                                                                                                  
 dropout_1 (Dropout)         (None, 106, 2048)            0         ['dense[0][0]']               
                                                                                                  
 re_lu (ReLU)                (None, 106, 2048)            0         ['dropout_1[0][0]']           
                                                                                                  
 dense_1 (Dense)             (None, 106, 1024)            2098176   ['re_lu[0][0]']               
                                                                                                  
 dropout_2 (Dropout)         (None, 106, 1024)            0         ['dense_1[0][0]']             
                                                                                                  
 add_1 (Add)                 (None, 106, 1024)            0         ['add[0][0]',                 
                                                                     'dropout_2[0][0]']           
                                                                                                  
 dense_2 (Dense)             (None, 106, 1)               1025      ['add_1[0][0]']               
                                                                                                  
 softmax (Softmax)           (None, 106, 1)               0         ['dense_2[0][0]']             
                                                                                                  
 multiply (Multiply)         (None, 106, 1024)            0         ['add_1[0][0]',               
                                                                     'softmax[0][0]']             
                                                                                                  
 lambda (Lambda)             (None, 1024)                 0         ['multiply[0][0]']            
                                                                                                  
 dense_3 (Dense)             (None, 512)                  524800    ['lambda[0][0]']              
                                                                                                  
 dense_4 (Dense)             (None, 256)                  131328    ['dense_3[0][0]']             
                                                                                                  
 re_lu_1 (ReLU)              (None, 256)                  0         ['dense_4[0][0]']             
                                                                                                  
 dense_5 (Dense)             (None, 128)                  32896     ['re_lu_1[0][0]']             
                                                                                                  
 dense_6 (Dense)             (None, 23)                   2967      ['dense_5[0][0]']             
                                                                                                  
==================================================================================================
Total params: 8173336 (31.18 MB)
Trainable params: 8173336 (31.18 MB)
Non-trainable params: 0 (0.00 Byte)
__________________________________________________________________________________________________
2025-05-20 16:43:58.308835: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:454] Loaded cuDNN version 8904
2025-05-20 16:43:58.868848: I external/local_xla/xla/service/service.cc:168] XLA service 0x7339564a9af0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-05-20 16:43:58.868876: I external/local_xla/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 4070, Compute Capability 8.9
2025-05-20 16:43:58.871358: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1747730638.909943   16187 device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
None
model_strides [1]
target_lengths [23]
target_crops [41]
No checkpoints found.
Successful first step!
/home/gl/anaconda3/envs/borzoi/lib/python3.10/site-packages/keras/src/engine/training.py:3103: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
Epoch 0 - 21s - train_loss: 0.8391 - train_r: 0.2117 - train_r2: -0.6816 - valid_loss: 0.3551 - valid_r: 0.5207 - valid_r2: 0.2596 - best!
Epoch 1 - 19s - train_loss: 0.3348 - train_r: 0.5691 - train_r2: 0.3159 - valid_loss: 0.3148 - valid_r: 0.6005 - valid_r2: 0.3426 - best!
Epoch 2 - 19s - train_loss: 0.3694 - train_r: 0.5354 - train_r2: 0.2453 - valid_loss: 0.3008 - valid_r: 0.6146 - valid_r2: 0.3729 - best!
Epoch 3 - 18s - train_loss: 0.2895 - train_r: 0.6371 - train_r2: 0.4062 - valid_loss: 0.2963 - valid_r: 0.6313 - valid_r2: 0.3816 - best!
Epoch 4 - 18s - train_loss: 0.2957 - train_r: 0.6299 - train_r2: 0.3919 - valid_loss: 0.2973 - valid_r: 0.6332 - valid_r2: 0.3794 - best!
Epoch 5 - 18s - train_loss: 0.2642 - train_r: 0.6745 - train_r2: 0.4573 - valid_loss: 0.2793 - valid_r: 0.6451 - valid_r2: 0.4164 - best!
Epoch 6 - 18s - train_loss: 0.2550 - train_r: 0.6876 - train_r2: 0.4754 - valid_loss: 0.2752 - valid_r: 0.6541 - valid_r2: 0.4245 - best!
Epoch 7 - 18s - train_loss: 0.2462 - train_r: 0.7005 - train_r2: 0.4933 - valid_loss: 0.2751 - valid_r: 0.6570 - valid_r2: 0.4248 - best!
Epoch 8 - 18s - train_loss: 0.2440 - train_r: 0.7037 - train_r2: 0.4977 - valid_loss: 0.2848 - valid_r: 0.6385 - valid_r2: 0.4045
Epoch 9 - 27s - train_loss: 0.2430 - train_r: 0.7053 - train_r2: 0.4999 - valid_loss: 0.2784 - valid_r: 0.6496 - valid_r2: 0.4183
Epoch 10 - 37s - train_loss: 0.2381 - train_r: 0.7122 - train_r2: 0.5098 - valid_loss: 0.2878 - valid_r: 0.6398 - valid_r2: 0.3990
Epoch 11 - 37s - train_loss: 0.2328 - train_r: 0.7196 - train_r2: 0.5204 - valid_loss: 0.2865 - valid_r: 0.6445 - valid_r2: 0.4011
Epoch 12 - 37s - train_loss: 0.2301 - train_r: 0.7233 - train_r2: 0.5257 - valid_loss: 0.2851 - valid_r: 0.6396 - valid_r2: 0.4037
Epoch 13 - 56s - train_loss: 0.2281 - train_r: 0.7261 - train_r2: 0.5298 - valid_loss: 0.2847 - valid_r: 0.6408 - valid_r2: 0.4043
Epoch 14 - 56s - train_loss: 0.2273 - train_r: 0.7270 - train_r2: 0.5312 - valid_loss: 0.2914 - valid_r: 0.6447 - valid_r2: 0.3898
Epoch 15 - 56s - train_loss: 0.2296 - train_r: 0.7240 - train_r2: 0.5267 - valid_loss: 0.2959 - valid_r: 0.6384 - valid_r2: 0.3824
Epoch 16 - 56s - train_loss: 0.2223 - train_r: 0.7342 - train_r2: 0.5416 - valid_loss: 0.2893 - valid_r: 0.6353 - valid_r2: 0.3956
Epoch 17 - 56s - train_loss: 0.3017 - train_r: 0.6328 - train_r2: 0.3791 - valid_loss: 0.3347 - valid_r: 0.5511 - valid_r2: 0.3038
Epoch 18 - 56s - train_loss: 0.2732 - train_r: 0.6613 - train_r2: 0.4395 - valid_loss: 0.3118 - valid_r: 0.6071 - valid_r2: 0.3509
Epoch 19 - 56s - train_loss: 0.2618 - train_r: 0.6784 - train_r2: 0.4626 - valid_loss: 0.3181 - valid_r: 0.6229 - valid_r2: 0.3372
Epoch 20 - 56s - train_loss: 0.2391 - train_r: 0.7109 - train_r2: 0.5078 - valid_loss: 0.2987 - valid_r: 0.6388 - valid_r2: 0.3767
Epoch 21 - 56s - train_loss: 0.2343 - train_r: 0.7174 - train_r2: 0.5172 - valid_loss: 0.2949 - valid_r: 0.6296 - valid_r2: 0.3844
Epoch 22 - 56s - train_loss: 0.2331 - train_r: 0.7192 - train_r2: 0.5198 - valid_loss: 0.3031 - valid_r: 0.6302 - valid_r2: 0.3681
Epoch 23 - 56s - train_loss: 0.2191 - train_r: 0.7382 - train_r2: 0.5476 - valid_loss: 0.2992 - valid_r: 0.6264 - valid_r2: 0.3758
Epoch 24 - 56s - train_loss: 0.2190 - train_r: 0.7385 - train_r2: 0.5481 - valid_loss: 0.3127 - valid_r: 0.6272 - valid_r2: 0.3482
Epoch 25 - 56s - train_loss: 0.2154 - train_r: 0.7435 - train_r2: 0.5555 - valid_loss: 0.3009 - valid_r: 0.6259 - valid_r2: 0.3723
Epoch 26 - 56s - train_loss: 0.2065 - train_r: 0.7551 - train_r2: 0.5730 - valid_loss: 0.3038 - valid_r: 0.6279 - valid_r2: 0.3670
Epoch 27 - 56s - train_loss: 0.2062 - train_r: 0.7556 - train_r2: 0.5737 - valid_loss: 0.2990 - valid_r: 0.6354 - valid_r2: 0.3760
Epoch 28 - 56s - train_loss: 0.2041 - train_r: 0.7584 - train_r2: 0.5780 - valid_loss: 0.2951 - valid_r: 0.6346 - valid_r2: 0.3842
