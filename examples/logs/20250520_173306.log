2025-05-20 17:33:06.244586: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-20 17:33:06.264022: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-05-20 17:33:06.264056: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-05-20 17:33:06.264676: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-20 17:33:06.267638: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-20 17:33:06.563290: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-05-20 17:33:06.977443: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:33:07.008638: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:33:07.010046: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:33:07.066578: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:33:07.067947: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:33:07.069211: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:33:07.141655: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:33:07.142625: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:33:07.143527: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:33:07.144415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1929] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9785 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070, pci bus id: 0000:01:00.0, compute capability: 8.9
Model: "model_1"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 tracks (InputLayer)         [(None, 106, 1024)]          0         []                            
                                                                                                  
 layer_normalization (Layer  (None, 106, 1024)            2048      ['tracks[0][0]']              
 Normalization)                                                                                   
                                                                                                  
 multihead_attention (Multi  (None, 106, 1024)            3278848   ['layer_normalization[0][0]'] 
 headAttention)                                                                                   
                                                                                                  
 dropout (Dropout)           (None, 106, 1024)            0         ['multihead_attention[0][0]'] 
                                                                                                  
 add (Add)                   (None, 106, 1024)            0         ['tracks[0][0]',              
                                                                     'dropout[0][0]']             
                                                                                                  
 layer_normalization_1 (Lay  (None, 106, 1024)            2048      ['add[0][0]']                 
 erNormalization)                                                                                 
                                                                                                  
 dense (Dense)               (None, 106, 2048)            2099200   ['layer_normalization_1[0][0]'
                                                                    ]                             
                                                                                                  
 dropout_1 (Dropout)         (None, 106, 2048)            0         ['dense[0][0]']               
                                                                                                  
 re_lu (ReLU)                (None, 106, 2048)            0         ['dropout_1[0][0]']           
                                                                                                  
 dense_1 (Dense)             (None, 106, 1024)            2098176   ['re_lu[0][0]']               
                                                                                                  
 dropout_2 (Dropout)         (None, 106, 1024)            0         ['dense_1[0][0]']             
                                                                                                  
 add_1 (Add)                 (None, 106, 1024)            0         ['add[0][0]',                 
                                                                     'dropout_2[0][0]']           
                                                                                                  
 dense_2 (Dense)             (None, 106, 1)               1025      ['add_1[0][0]']               
                                                                                                  
 softmax (Softmax)           (None, 106, 1)               0         ['dense_2[0][0]']             
                                                                                                  
 multiply (Multiply)         (None, 106, 1024)            0         ['add_1[0][0]',               
                                                                     'softmax[0][0]']             
                                                                                                  
 lambda (Lambda)             (None, 1024)                 0         ['multiply[0][0]']            
                                                                                                  
 dense_3 (Dense)             (None, 512)                  524800    ['lambda[0][0]']              
                                                                                                  
 dense_4 (Dense)             (None, 256)                  131328    ['dense_3[0][0]']             
                                                                                                  
 re_lu_1 (ReLU)              (None, 256)                  0         ['dense_4[0][0]']             
                                                                                                  
 dense_5 (Dense)             (None, 128)                  32896     ['re_lu_1[0][0]']             
                                                                                                  
 dense_6 (Dense)             (None, 23)                   2967      ['dense_5[0][0]']             
                                                                                                  
==================================================================================================
Total params: 8173336 (31.18 MB)
Trainable params: 8173336 (31.18 MB)
Non-trainable params: 0 (0.00 Byte)
__________________________________________________________________________________________________
2025-05-20 17:33:08.688357: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:454] Loaded cuDNN version 8904
2025-05-20 17:33:09.225986: I external/local_xla/xla/service/service.cc:168] XLA service 0x71ac7e5ae870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-05-20 17:33:09.226015: I external/local_xla/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 4070, Compute Capability 8.9
2025-05-20 17:33:09.228674: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1747733589.267715   32963 device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
None
model_strides [1]
target_lengths [23]
target_crops [41]
No checkpoints found.
Successful first step!
/home/gl/anaconda3/envs/borzoi/lib/python3.10/site-packages/keras/src/engine/training.py:3103: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
Epoch 0 - 21s - train_loss: 0.8815 - train_r: 0.2378 - train_r2: -0.8190 - valid_loss: 0.3272 - valid_r: 0.5680 - valid_r2: 0.3154 - best!
Epoch 1 - 18s - train_loss: 0.3225 - train_r: 0.5861 - train_r2: 0.3378 - valid_loss: 0.3106 - valid_r: 0.6124 - valid_r2: 0.3516 - best!
Epoch 2 - 18s - train_loss: 0.2921 - train_r: 0.6324 - train_r2: 0.4007 - valid_loss: 0.2951 - valid_r: 0.6244 - valid_r2: 0.3824 - best!
Epoch 3 - 18s - train_loss: 0.2930 - train_r: 0.6321 - train_r2: 0.3982 - valid_loss: 0.3020 - valid_r: 0.6330 - valid_r2: 0.3682 - best!
Epoch 4 - 18s - train_loss: 0.2745 - train_r: 0.6595 - train_r2: 0.4362 - valid_loss: 0.2913 - valid_r: 0.6268 - valid_r2: 0.3903
Epoch 5 - 18s - train_loss: 0.2721 - train_r: 0.6627 - train_r2: 0.4410 - valid_loss: 0.2833 - valid_r: 0.6400 - valid_r2: 0.4072 - best!
Epoch 6 - 33s - train_loss: 0.2540 - train_r: 0.6897 - train_r2: 0.4780 - valid_loss: 0.2867 - valid_r: 0.6340 - valid_r2: 0.4006
Epoch 7 - 76s - train_loss: 0.2527 - train_r: 0.6915 - train_r2: 0.4806 - valid_loss: 0.2900 - valid_r: 0.6296 - valid_r2: 0.3929
Epoch 8 - 93s - train_loss: 0.2491 - train_r: 0.6964 - train_r2: 0.4874 - valid_loss: 0.2926 - valid_r: 0.6297 - valid_r2: 0.3883
Epoch 9 - 94s - train_loss: 0.2513 - train_r: 0.6935 - train_r2: 0.4833 - valid_loss: 0.2981 - valid_r: 0.6201 - valid_r2: 0.3770
Epoch 10 - 111s - train_loss: 0.2527 - train_r: 0.6914 - train_r2: 0.4805 - valid_loss: 0.2916 - valid_r: 0.6259 - valid_r2: 0.3906
Epoch 11 - 127s - train_loss: 0.2469 - train_r: 0.6996 - train_r2: 0.4919 - valid_loss: 0.2943 - valid_r: 0.6354 - valid_r2: 0.3842
Epoch 12 - 130s - train_loss: 0.2540 - train_r: 0.6893 - train_r2: 0.4776 - valid_loss: 0.3244 - valid_r: 0.5862 - valid_r2: 0.3242
Epoch 13 - 131s - train_loss: 0.2627 - train_r: 0.6771 - train_r2: 0.4607 - valid_loss: 0.3047 - valid_r: 0.6034 - valid_r2: 0.3645
Epoch 14 - 131s - train_loss: 0.2581 - train_r: 0.6837 - train_r2: 0.4697 - valid_loss: 0.3001 - valid_r: 0.6131 - valid_r2: 0.3724
Epoch 15 - 131s - train_loss: 0.2489 - train_r: 0.6971 - train_r2: 0.4883 - valid_loss: 0.2988 - valid_r: 0.6188 - valid_r2: 0.3761
Epoch 16 - 131s - train_loss: 0.2576 - train_r: 0.6844 - train_r2: 0.4706 - valid_loss: 0.2998 - valid_r: 0.6126 - valid_r2: 0.3750
Epoch 17 - 131s - train_loss: 0.2578 - train_r: 0.6843 - train_r2: 0.4705 - valid_loss: 0.3034 - valid_r: 0.6102 - valid_r2: 0.3655
Epoch 18 - 131s - train_loss: 0.2614 - train_r: 0.6790 - train_r2: 0.4632 - valid_loss: 0.2968 - valid_r: 0.6202 - valid_r2: 0.3806
Epoch 19 - 131s - train_loss: 0.2360 - train_r: 0.7152 - train_r2: 0.5140 - valid_loss: 0.2991 - valid_r: 0.6204 - valid_r2: 0.3757
Epoch 20 - 131s - train_loss: 0.2596 - train_r: 0.6818 - train_r2: 0.4670 - valid_loss: 0.3110 - valid_r: 0.5927 - valid_r2: 0.3514
Epoch 21 - 131s - train_loss: 0.2656 - train_r: 0.6728 - train_r2: 0.4549 - valid_loss: 0.3024 - valid_r: 0.6196 - valid_r2: 0.3688
Epoch 22 - 130s - train_loss: 0.2378 - train_r: 0.7128 - train_r2: 0.5105 - valid_loss: 0.2935 - valid_r: 0.6352 - valid_r2: 0.3879
Epoch 23 - 130s - train_loss: 0.2331 - train_r: 0.7193 - train_r2: 0.5200 - valid_loss: 0.2996 - valid_r: 0.6205 - valid_r2: 0.3748
Epoch 24 - 131s - train_loss: 0.2756 - train_r: 0.6577 - train_r2: 0.4347 - valid_loss: 0.3189 - valid_r: 0.5856 - valid_r2: 0.3355
Epoch 25 - 131s - train_loss: 0.2981 - train_r: 0.6228 - train_r2: 0.3898 - valid_loss: 0.3091 - valid_r: 0.5986 - valid_r2: 0.3544
Epoch 26 - 131s - train_loss: 0.3783 - train_r: 0.4786 - train_r2: 0.2290 - valid_loss: 0.3625 - valid_r: 0.4970 - valid_r2: 0.2466
