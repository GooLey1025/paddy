2025-05-20 17:36:34.241232: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-20 17:36:34.260798: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-05-20 17:36:34.260827: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-05-20 17:36:34.261329: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-20 17:36:34.264281: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-20 17:36:34.602588: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-05-20 17:36:35.038067: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:36:35.068933: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:36:35.070361: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:36:35.133900: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:36:35.136530: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:36:35.139106: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:36:35.462871: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:36:35.464559: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:36:35.466462: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 17:36:35.468476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1929] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 4978 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070, pci bus id: 0000:01:00.0, compute capability: 8.9
Model: "model_1"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 tracks (InputLayer)         [(None, 106, 1024)]          0         []                            
                                                                                                  
 layer_normalization (Layer  (None, 106, 1024)            2048      ['tracks[0][0]']              
 Normalization)                                                                                   
                                                                                                  
 multihead_attention (Multi  (None, 106, 1024)            4459520   ['layer_normalization[0][0]'] 
 headAttention)                                                                                   
                                                                                                  
 dropout (Dropout)           (None, 106, 1024)            0         ['multihead_attention[0][0]'] 
                                                                                                  
 add (Add)                   (None, 106, 1024)            0         ['tracks[0][0]',              
                                                                     'dropout[0][0]']             
                                                                                                  
 layer_normalization_1 (Lay  (None, 106, 1024)            2048      ['add[0][0]']                 
 erNormalization)                                                                                 
                                                                                                  
 dense (Dense)               (None, 106, 2048)            2099200   ['layer_normalization_1[0][0]'
                                                                    ]                             
                                                                                                  
 dropout_1 (Dropout)         (None, 106, 2048)            0         ['dense[0][0]']               
                                                                                                  
 re_lu (ReLU)                (None, 106, 2048)            0         ['dropout_1[0][0]']           
                                                                                                  
 dense_1 (Dense)             (None, 106, 1024)            2098176   ['re_lu[0][0]']               
                                                                                                  
 dropout_2 (Dropout)         (None, 106, 1024)            0         ['dense_1[0][0]']             
                                                                                                  
 add_1 (Add)                 (None, 106, 1024)            0         ['add[0][0]',                 
                                                                     'dropout_2[0][0]']           
                                                                                                  
 dense_2 (Dense)             (None, 106, 1)               1025      ['add_1[0][0]']               
                                                                                                  
 softmax (Softmax)           (None, 106, 1)               0         ['dense_2[0][0]']             
                                                                                                  
 multiply (Multiply)         (None, 106, 1024)            0         ['add_1[0][0]',               
                                                                     'softmax[0][0]']             
                                                                                                  
 lambda (Lambda)             (None, 1024)                 0         ['multiply[0][0]']            
                                                                                                  
 dense_3 (Dense)             (None, 512)                  524800    ['lambda[0][0]']              
                                                                                                  
 dense_4 (Dense)             (None, 256)                  131328    ['dense_3[0][0]']             
                                                                                                  
 re_lu_1 (ReLU)              (None, 256)                  0         ['dense_4[0][0]']             
                                                                                                  
 dense_5 (Dense)             (None, 128)                  32896     ['re_lu_1[0][0]']             
                                                                                                  
 dense_6 (Dense)             (None, 23)                   2967      ['dense_5[0][0]']             
                                                                                                  
==================================================================================================
Total params: 9354008 (35.68 MB)
Trainable params: 9354008 (35.68 MB)
Non-trainable params: 0 (0.00 Byte)
__________________________________________________________________________________________________
2025-05-20 17:36:37.828248: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:454] Loaded cuDNN version 8904
2025-05-20 17:36:38.805071: I external/local_xla/xla/service/service.cc:168] XLA service 0x7a72970fc620 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-05-20 17:36:38.805114: I external/local_xla/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 4070, Compute Capability 8.9
2025-05-20 17:36:38.807761: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1747733798.847126   39029 device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
None
model_strides [1]
target_lengths [23]
target_crops [41]
No checkpoints found.
Successful first step!
/home/gl/anaconda3/envs/borzoi/lib/python3.10/site-packages/keras/src/engine/training.py:3103: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
Epoch 0 - 111s - train_loss: 0.6495 - train_r: 0.3025 - train_r2: -0.3275 - valid_loss: 0.3159 - valid_r: 0.5857 - valid_r2: 0.3410 - best!
Epoch 1 - 108s - train_loss: 0.3219 - train_r: 0.5871 - train_r2: 0.3416 - valid_loss: 0.3039 - valid_r: 0.6084 - valid_r2: 0.3648 - best!
Epoch 2 - 130s - train_loss: 0.3266 - train_r: 0.5792 - train_r2: 0.3319 - valid_loss: 0.2958 - valid_r: 0.6168 - valid_r2: 0.3811 - best!
Epoch 3 - 150s - train_loss: 0.2842 - train_r: 0.6441 - train_r2: 0.4170 - valid_loss: 0.2894 - valid_r: 0.6293 - valid_r2: 0.3941 - best!
Epoch 4 - 151s - train_loss: 0.2753 - train_r: 0.6582 - train_r2: 0.4352 - valid_loss: 0.2839 - valid_r: 0.6390 - valid_r2: 0.4054 - best!
Epoch 5 - 150s - train_loss: 0.2674 - train_r: 0.6696 - train_r2: 0.4508 - valid_loss: 0.2826 - valid_r: 0.6369 - valid_r2: 0.4076
Epoch 6 - 151s - train_loss: 0.2628 - train_r: 0.6763 - train_r2: 0.4599 - valid_loss: 0.2879 - valid_r: 0.6370 - valid_r2: 0.3966
Epoch 7 - 150s - train_loss: 0.2618 - train_r: 0.6780 - train_r2: 0.4621 - valid_loss: 0.2836 - valid_r: 0.6359 - valid_r2: 0.4059
Epoch 8 - 150s - train_loss: 0.2590 - train_r: 0.6820 - train_r2: 0.4676 - valid_loss: 0.2828 - valid_r: 0.6439 - valid_r2: 0.4080 - best!
Epoch 9 - 151s - train_loss: 0.2546 - train_r: 0.6884 - train_r2: 0.4764 - valid_loss: 0.2911 - valid_r: 0.6342 - valid_r2: 0.3907
Epoch 10 - 150s - train_loss: 0.2526 - train_r: 0.6913 - train_r2: 0.4805 - valid_loss: 0.2948 - valid_r: 0.6280 - valid_r2: 0.3833
Epoch 11 - 150s - train_loss: 0.2512 - train_r: 0.6934 - train_r2: 0.4833 - valid_loss: 0.2867 - valid_r: 0.6328 - valid_r2: 0.4004
Epoch 12 - 150s - train_loss: 0.2479 - train_r: 0.6980 - train_r2: 0.4898 - valid_loss: 0.2941 - valid_r: 0.6260 - valid_r2: 0.3851
Epoch 13 - 150s - train_loss: 0.2508 - train_r: 0.6940 - train_r2: 0.4841 - valid_loss: 0.2925 - valid_r: 0.6351 - valid_r2: 0.3878
Epoch 14 - 149s - train_loss: 0.2419 - train_r: 0.7066 - train_r2: 0.5019 - valid_loss: 0.3140 - valid_r: 0.5996 - valid_r2: 0.3409
Epoch 15 - 150s - train_loss: 0.2416 - train_r: 0.7070 - train_r2: 0.5024 - valid_loss: 0.2941 - valid_r: 0.6264 - valid_r2: 0.3855
Epoch 16 - 145s - train_loss: 0.2401 - train_r: 0.7094 - train_r2: 0.5058 - valid_loss: 0.2921 - valid_r: 0.6368 - valid_r2: 0.3890
Epoch 17 - 128s - train_loss: 0.2334 - train_r: 0.7186 - train_r2: 0.5190 - valid_loss: 0.3092 - valid_r: 0.6304 - valid_r2: 0.3543
Epoch 18 - 128s - train_loss: 0.2290 - train_r: 0.7244 - train_r2: 0.5275 - valid_loss: 0.2789 - valid_r: 0.6462 - valid_r2: 0.4157 - best!
Epoch 19 - 128s - train_loss: 0.2220 - train_r: 0.7341 - train_r2: 0.5417 - valid_loss: 0.2829 - valid_r: 0.6477 - valid_r2: 0.4087
Epoch 20 - 129s - train_loss: 0.2230 - train_r: 0.7326 - train_r2: 0.5395 - valid_loss: 0.2888 - valid_r: 0.6344 - valid_r2: 0.3964
Epoch 21 - 116s - train_loss: 0.2165 - train_r: 0.7413 - train_r2: 0.5525 - valid_loss: 0.2966 - valid_r: 0.6374 - valid_r2: 0.3803
Epoch 22 - 89s - train_loss: 0.2233 - train_r: 0.7321 - train_r2: 0.5388 - valid_loss: 0.2968 - valid_r: 0.6217 - valid_r2: 0.3793
Epoch 23 - 74s - train_loss: 0.2839 - train_r: 0.6452 - train_r2: 0.4180 - valid_loss: 0.3163 - valid_r: 0.5841 - valid_r2: 0.3399
Epoch 24 - 43s - train_loss: 0.2423 - train_r: 0.7061 - train_r2: 0.5011 - valid_loss: 0.2792 - valid_r: 0.6476 - valid_r2: 0.4156 - best!
Epoch 25 - 43s - train_loss: 0.2157 - train_r: 0.7428 - train_r2: 0.5545 - valid_loss: 0.2894 - valid_r: 0.6415 - valid_r2: 0.3938
Epoch 26 - 42s - train_loss: 0.2226 - train_r: 0.7334 - train_r2: 0.5406 - valid_loss: 0.2940 - valid_r: 0.6313 - valid_r2: 0.3857
Epoch 27 - 36s - train_loss: 0.2267 - train_r: 0.7279 - train_r2: 0.5325 - valid_loss: 0.3021 - valid_r: 0.6247 - valid_r2: 0.3694
Epoch 28 - 21s - train_loss: 0.2282 - train_r: 0.7257 - train_r2: 0.5293 - valid_loss: 0.3119 - valid_r: 0.6366 - valid_r2: 0.3485
Epoch 29 - 21s - train_loss: 0.2343 - train_r: 0.7174 - train_r2: 0.5172 - valid_loss: 0.3221 - valid_r: 0.5963 - valid_r2: 0.3279
Epoch 30 - 21s - train_loss: 0.2465 - train_r: 0.7001 - train_r2: 0.4926 - valid_loss: 0.3026 - valid_r: 0.6222 - valid_r2: 0.3684
Epoch 31 - 21s - train_loss: 0.2736 - train_r: 0.6605 - train_r2: 0.4385 - valid_loss: 0.3356 - valid_r: 0.5541 - valid_r2: 0.3008
Epoch 32 - 21s - train_loss: 0.2754 - train_r: 0.6577 - train_r2: 0.4349 - valid_loss: 0.3569 - valid_r: 0.5634 - valid_r2: 0.2561
Epoch 33 - 21s - train_loss: 0.2712 - train_r: 0.6642 - train_r2: 0.4434 - valid_loss: 0.3094 - valid_r: 0.5993 - valid_r2: 0.3535
Epoch 34 - 21s - train_loss: 0.2733 - train_r: 0.6608 - train_r2: 0.4391 - valid_loss: 0.3155 - valid_r: 0.6002 - valid_r2: 0.3418
Epoch 35 - 21s - train_loss: 0.2533 - train_r: 0.6902 - train_r2: 0.4789 - valid_loss: 0.3073 - valid_r: 0.6057 - valid_r2: 0.3582
Epoch 36 - 21s - train_loss: 0.2330 - train_r: 0.7191 - train_r2: 0.5198 - valid_loss: 0.3146 - valid_r: 0.6036 - valid_r2: 0.3434
Epoch 37 - 21s - train_loss: 0.2305 - train_r: 0.7226 - train_r2: 0.5248 - valid_loss: 0.3335 - valid_r: 0.5916 - valid_r2: 0.3041
Epoch 38 - 21s - train_loss: 0.2272 - train_r: 0.7271 - train_r2: 0.5315 - valid_loss: 0.3081 - valid_r: 0.6117 - valid_r2: 0.3556
Epoch 39 - 21s - train_loss: 0.2327 - train_r: 0.7194 - train_r2: 0.5203 - valid_loss: 0.3052 - valid_r: 0.6101 - valid_r2: 0.3607
Epoch 40 - 21s - train_loss: 0.2217 - train_r: 0.7347 - train_r2: 0.5426 - valid_loss: 0.3035 - valid_r: 0.6208 - valid_r2: 0.3650
Epoch 41 - 21s - train_loss: 0.2089 - train_r: 0.7517 - train_r2: 0.5680 - valid_loss: 0.3001 - valid_r: 0.6226 - valid_r2: 0.3722
Epoch 42 - 21s - train_loss: 0.2067 - train_r: 0.7547 - train_r2: 0.5725 - valid_loss: 0.3195 - valid_r: 0.6195 - valid_r2: 0.3329
Epoch 43 - 21s - train_loss: 0.2053 - train_r: 0.7563 - train_r2: 0.5751 - valid_loss: 0.3495 - valid_r: 0.6293 - valid_r2: 0.2726
Epoch 44 - 21s - train_loss: 0.2012 - train_r: 0.7618 - train_r2: 0.5833 - valid_loss: 0.3214 - valid_r: 0.6192 - valid_r2: 0.3301
Epoch 45 - 21s - train_loss: 0.1958 - train_r: 0.7690 - train_r2: 0.5944 - valid_loss: 0.3149 - valid_r: 0.6240 - valid_r2: 0.3426
