2025-05-20 16:46:58.232283: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-05-20 16:46:58.254853: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-05-20 16:46:58.254891: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-05-20 16:46:58.255409: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-05-20 16:46:58.258381: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-20 16:46:58.596826: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-05-20 16:46:59.007695: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:46:59.043406: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:46:59.044782: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:46:59.105335: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:46:59.107597: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:46:59.109862: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:46:59.246272: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:46:59.248385: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:46:59.249569: I external/local_xla/xla/stream_executor/cuda/cuda_executor.cc:901] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2025-05-20 16:46:59.250764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1929] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 7560 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4070, pci bus id: 0000:01:00.0, compute capability: 8.9
Model: "model_1"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 tracks (InputLayer)         [(None, 106, 1024)]          0         []                            
                                                                                                  
 layer_normalization (Layer  (None, 106, 1024)            2048      ['tracks[0][0]']              
 Normalization)                                                                                   
                                                                                                  
 multihead_attention (Multi  (None, 106, 1024)            3278848   ['layer_normalization[0][0]'] 
 headAttention)                                                                                   
                                                                                                  
 dropout (Dropout)           (None, 106, 1024)            0         ['multihead_attention[0][0]'] 
                                                                                                  
 add (Add)                   (None, 106, 1024)            0         ['tracks[0][0]',              
                                                                     'dropout[0][0]']             
                                                                                                  
 layer_normalization_1 (Lay  (None, 106, 1024)            2048      ['add[0][0]']                 
 erNormalization)                                                                                 
                                                                                                  
 dense (Dense)               (None, 106, 2048)            2099200   ['layer_normalization_1[0][0]'
                                                                    ]                             
                                                                                                  
 dropout_1 (Dropout)         (None, 106, 2048)            0         ['dense[0][0]']               
                                                                                                  
 re_lu (ReLU)                (None, 106, 2048)            0         ['dropout_1[0][0]']           
                                                                                                  
 dense_1 (Dense)             (None, 106, 1024)            2098176   ['re_lu[0][0]']               
                                                                                                  
 dropout_2 (Dropout)         (None, 106, 1024)            0         ['dense_1[0][0]']             
                                                                                                  
 add_1 (Add)                 (None, 106, 1024)            0         ['add[0][0]',                 
                                                                     'dropout_2[0][0]']           
                                                                                                  
 dense_2 (Dense)             (None, 106, 1)               1025      ['add_1[0][0]']               
                                                                                                  
 softmax (Softmax)           (None, 106, 1)               0         ['dense_2[0][0]']             
                                                                                                  
 multiply (Multiply)         (None, 106, 1024)            0         ['add_1[0][0]',               
                                                                     'softmax[0][0]']             
                                                                                                  
 lambda (Lambda)             (None, 1024)                 0         ['multiply[0][0]']            
                                                                                                  
 dense_3 (Dense)             (None, 512)                  524800    ['lambda[0][0]']              
                                                                                                  
 dense_4 (Dense)             (None, 256)                  131328    ['dense_3[0][0]']             
                                                                                                  
 re_lu_1 (ReLU)              (None, 256)                  0         ['dense_4[0][0]']             
                                                                                                  
 dense_5 (Dense)             (None, 128)                  32896     ['re_lu_1[0][0]']             
                                                                                                  
 dense_6 (Dense)             (None, 23)                   2967      ['dense_5[0][0]']             
                                                                                                  
==================================================================================================
Total params: 8173336 (31.18 MB)
Trainable params: 8173336 (31.18 MB)
Non-trainable params: 0 (0.00 Byte)
__________________________________________________________________________________________________
2025-05-20 16:47:01.141702: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:454] Loaded cuDNN version 8904
2025-05-20 16:47:01.876001: I external/local_xla/xla/service/service.cc:168] XLA service 0x724c4e9c43e0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2025-05-20 16:47:01.876037: I external/local_xla/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 4070, Compute Capability 8.9
2025-05-20 16:47:01.879283: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1747730821.925207   18683 device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
None
model_strides [1]
target_lengths [23]
target_crops [41]
No checkpoints found.
Successful first step!
/home/gl/anaconda3/envs/borzoi/lib/python3.10/site-packages/keras/src/engine/training.py:3103: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
Epoch 0 - 41s - train_loss: 1.6875 - train_r: 0.0902 - train_r2: -2.3912 - valid_loss: 0.5054 - valid_r: 0.3547 - valid_r2: -0.0528 - best!
Epoch 1 - 37s - train_loss: 0.4024 - train_r: 0.4743 - train_r2: 0.1795 - valid_loss: 0.3488 - valid_r: 0.5301 - valid_r2: 0.2723 - best!
Epoch 2 - 37s - train_loss: 0.3577 - train_r: 0.5446 - train_r2: 0.2678 - valid_loss: 0.3088 - valid_r: 0.5992 - valid_r2: 0.3557 - best!
Epoch 3 - 47s - train_loss: 0.3138 - train_r: 0.6012 - train_r2: 0.3572 - valid_loss: 0.3004 - valid_r: 0.6152 - valid_r2: 0.3735 - best!
Epoch 4 - 56s - train_loss: 0.3563 - train_r: 0.5415 - train_r2: 0.2718 - valid_loss: 0.3274 - valid_r: 0.5686 - valid_r2: 0.3173
Epoch 5 - 56s - train_loss: 0.3161 - train_r: 0.5938 - train_r2: 0.3533 - valid_loss: 0.3276 - valid_r: 0.5710 - valid_r2: 0.3175
Epoch 6 - 56s - train_loss: 0.2972 - train_r: 0.6241 - train_r2: 0.3913 - valid_loss: 0.3022 - valid_r: 0.6070 - valid_r2: 0.3695
Epoch 7 - 56s - train_loss: 0.2922 - train_r: 0.6319 - train_r2: 0.4011 - valid_loss: 0.2994 - valid_r: 0.6144 - valid_r2: 0.3752
Epoch 8 - 56s - train_loss: 0.2799 - train_r: 0.6511 - train_r2: 0.4260 - valid_loss: 0.2946 - valid_r: 0.6210 - valid_r2: 0.3846 - best!
Epoch 9 - 56s - train_loss: 0.2699 - train_r: 0.6661 - train_r2: 0.4459 - valid_loss: 0.2944 - valid_r: 0.6239 - valid_r2: 0.3853 - best!
Epoch 10 - 56s - train_loss: 0.2624 - train_r: 0.6771 - train_r2: 0.4608 - valid_loss: 0.2842 - valid_r: 0.6380 - valid_r2: 0.4060 - best!
Epoch 11 - 56s - train_loss: 0.2576 - train_r: 0.6844 - train_r2: 0.4707 - valid_loss: 0.2797 - valid_r: 0.6438 - valid_r2: 0.4150 - best!
Epoch 12 - 56s - train_loss: 0.2486 - train_r: 0.6972 - train_r2: 0.4885 - valid_loss: 0.2819 - valid_r: 0.6430 - valid_r2: 0.4102
Epoch 13 - 56s - train_loss: 0.2466 - train_r: 0.7002 - train_r2: 0.4927 - valid_loss: 0.2791 - valid_r: 0.6455 - valid_r2: 0.4162 - best!
Epoch 14 - 56s - train_loss: 0.2379 - train_r: 0.7125 - train_r2: 0.5100 - valid_loss: 0.2774 - valid_r: 0.6490 - valid_r2: 0.4194 - best!
Epoch 15 - 56s - train_loss: 0.2313 - train_r: 0.7219 - train_r2: 0.5235 - valid_loss: 0.2875 - valid_r: 0.6392 - valid_r2: 0.3993
Epoch 16 - 56s - train_loss: 0.2237 - train_r: 0.7323 - train_r2: 0.5388 - valid_loss: 0.2881 - valid_r: 0.6411 - valid_r2: 0.3973
Epoch 17 - 56s - train_loss: 0.2174 - train_r: 0.7407 - train_r2: 0.5512 - valid_loss: 0.2811 - valid_r: 0.6416 - valid_r2: 0.4124
Epoch 18 - 56s - train_loss: 0.2124 - train_r: 0.7476 - train_r2: 0.5614 - valid_loss: 0.2865 - valid_r: 0.6402 - valid_r2: 0.4017
Epoch 19 - 45s - train_loss: 0.2030 - train_r: 0.7600 - train_r2: 0.5802 - valid_loss: 0.2896 - valid_r: 0.6356 - valid_r2: 0.3948
Epoch 20 - 37s - train_loss: 0.2012 - train_r: 0.7623 - train_r2: 0.5837 - valid_loss: 0.2932 - valid_r: 0.6327 - valid_r2: 0.3880
Epoch 21 - 37s - train_loss: 0.1978 - train_r: 0.7670 - train_r2: 0.5909 - valid_loss: 0.2964 - valid_r: 0.6237 - valid_r2: 0.3809
Epoch 22 - 37s - train_loss: 0.1914 - train_r: 0.7750 - train_r2: 0.6035 - valid_loss: 0.3286 - valid_r: 0.6144 - valid_r2: 0.3159
Epoch 23 - 37s - train_loss: 0.1860 - train_r: 0.7818 - train_r2: 0.6141 - valid_loss: 0.2928 - valid_r: 0.6315 - valid_r2: 0.3882
Epoch 24 - 37s - train_loss: 0.1743 - train_r: 0.7969 - train_r2: 0.6380 - valid_loss: 0.2948 - valid_r: 0.6228 - valid_r2: 0.3840
Epoch 25 - 37s - train_loss: 0.1694 - train_r: 0.8031 - train_r2: 0.6479 - valid_loss: 0.2978 - valid_r: 0.6226 - valid_r2: 0.3787
Epoch 26 - 37s - train_loss: 0.1675 - train_r: 0.8053 - train_r2: 0.6515 - valid_loss: 0.2965 - valid_r: 0.6281 - valid_r2: 0.3809
Epoch 27 - 37s - train_loss: 0.1598 - train_r: 0.8150 - train_r2: 0.6673 - valid_loss: 0.2973 - valid_r: 0.6273 - valid_r2: 0.3785
Epoch 28 - 20s - train_loss: 0.1563 - train_r: 0.8194 - train_r2: 0.6744 - valid_loss: 0.3007 - valid_r: 0.6168 - valid_r2: 0.3711
Epoch 29 - 18s - train_loss: 0.1524 - train_r: 0.8241 - train_r2: 0.6821 - valid_loss: 0.2992 - valid_r: 0.6246 - valid_r2: 0.3744
Epoch 30 - 18s - train_loss: 0.1577 - train_r: 0.8176 - train_r2: 0.6714 - valid_loss: 0.3028 - valid_r: 0.6212 - valid_r2: 0.3676
Epoch 31 - 18s - train_loss: 0.1556 - train_r: 0.8203 - train_r2: 0.6758 - valid_loss: 0.3172 - valid_r: 0.6260 - valid_r2: 0.3370
Epoch 32 - 18s - train_loss: 0.1453 - train_r: 0.8328 - train_r2: 0.6966 - valid_loss: 0.3361 - valid_r: 0.6336 - valid_r2: 0.2980
Epoch 33 - 18s - train_loss: 0.1406 - train_r: 0.8385 - train_r2: 0.7061 - valid_loss: 0.2989 - valid_r: 0.6326 - valid_r2: 0.3744
Epoch 34 - 18s - train_loss: 0.1371 - train_r: 0.8427 - train_r2: 0.7132 - valid_loss: 0.3291 - valid_r: 0.6249 - valid_r2: 0.3117
Epoch 35 - 18s - train_loss: 0.1382 - train_r: 0.8415 - train_r2: 0.7112 - valid_loss: 0.3101 - valid_r: 0.6180 - valid_r2: 0.3516
